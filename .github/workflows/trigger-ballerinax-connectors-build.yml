name: Trigger ballerinax connectors build

on:
  workflow_dispatch:

jobs:
  trigger_repository_disptach:
    name: Trigger repository dispatch in ballerinax connector repos
    strategy:
      fail-fast: false
      matrix:
        modules:
          - aws.dynamodb
          - aws.s3
          - aws.ses
          - aws.simpledb
          - aws.sns
          - aws.sqs
          - azure-cosmosdb
          - azure-service-bus
          - azure-storage-service
          - azure.ad
          - azure.eventhub
          - cdata.connect
          - cdata.connect.driver
          - github
          - googleapis.calendar
          - googleapis.drive
          - googleapis.gmail
          - googleapis.people
          - googleapis.sheets
          - microsoft.excel
          - microsoft.onedrive
          - microsoft.onenote
          - microsoft.outlook.calendar
          - microsoft.outlook.mail
          - microsoft.teams
          - mongodb
          - netsuite
          - peoplehr
          - sfdc
          - slack
          - snowflake
          - snowflake.driver
          - twilio
          - twitter
    runs-on: ubuntu-latest
    steps:
      - name: dispatch build request
        run: |
          curl --request \
          POST 'https://api.github.com/repos/ballerina-platform/module-ballerinax-${{matrix.modules}}/dispatches' \
          --header 'Accept: application/vnd.github.v3+json' \
          --header 'Content-Type: application/json' \
          --header 'Authorization: token ${{secrets.BALLERINA_BOT_TOKEN}}' \
          --data-raw '{
              "event_type":"check_connector_for_breaking_changes"
          }'
